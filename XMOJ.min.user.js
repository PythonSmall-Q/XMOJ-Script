// ==UserScript==
// @name         XMOJ
// @version      0.1.16
// @description  Test
// @author       @langningchen
// @match        http://www.xmoj.tech/*
// @require      https://cdn.bootcdn.net/ajax/libs/crypto-js/4.1.1/crypto-js.min.js
// @require      https://cdn.bootcdn.net/ajax/libs/crypto-js/4.1.1/hmac-sha1.min.js
// @require      https://ghproxy.com/https://raw.githubusercontent.com/drudru/ansi_up/master/ansi_up.js
// @grant        GM_registerMenuCommand
// ==/UserScript==
/**
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 * You should have received a copy of the GNU General Public License along with this program. If not, see <https://www.gnu.org/licenses/>.
 */
(async()=>{let SecondsToString=e=>{var t=Math.floor(e/3600),n=Math.floor(e%3600/60),e=e%60;return(t<10?"0":"")+t+":"+(n<10?"0":"")+n+":"+(e<10?"0":"")+e},StringToSeconds=e=>{e=e.split(":");return 60*parseInt(e[0])*60+60*parseInt(e[1])+parseInt(e[2])},SizeToStringSize=e=>UtilityEnabled("AddUnits")?e<1024?e+"B":e<1048576?(e/1024).toFixed(2)+"KB":e<1073741824?(e/1024/1024).toFixed(2)+"MB":(e/1024/1024/1024).toFixed(2)+"GB":e,TimeToStringTime=e=>UtilityEnabled("AddUnits")?e<1e3?e+"ms":e<6e4?(e/1e3).toFixed(2)+"s":e<36e5?(e/1e3/60).toFixed(2)+"min":(e/1e3/60/60).toFixed(2)+"h":e,TidyTable=e=>{if(UtilityEnabled("NewBootstrap")&&null!=e){e.className="table table-hover",e.querySelector("thead > tr").removeAttribute("class"),e.querySelector("thead > tr").removeAttribute("align"),e.querySelector("thead > tr").innerHTML=e.querySelector("thead > tr").innerHTML.replaceAll("td","th");let t=e.querySelector("thead > tr").children;for(let e=0;e<t.length;e++){var n=t[e].style.width;t[e].removeAttribute("style"),t[e].style.width=n,t[e].removeAttribute("onclick"),t[e].removeAttribute("align")}e.querySelector("tbody").className="table-group-divider",t=e.querySelector("tbody").children;for(let e=0;e<t.length;e++){t[e].removeAttribute("align");var o=t[e].querySelectorAll("*");for(let e=0;e<o.length;e++)o[e].classList.remove("left"),o[e].classList.remove("center"),""==o[e].className&&o[e].removeAttribute("class")}}},CopyToClipboard=e=>{var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove()},UtilityEnabled=e=>(null==localStorage.getItem("UserScript-Setting-"+e)&&localStorage.setItem("UserScript-Setting-"+e,"true"),"true"==localStorage.getItem("UserScript-Setting-"+e));if(GM_registerMenuCommand("重置数据",()=>{for(let e=0;e<localStorage.length;e++)"UserScript"==localStorage.key(e).substring(0,10)&&localStorage.removeItem(localStorage.key(e));location.reload()}),null==localStorage.getItem("UserScript-Debug")&&(window.onkeydown=e=>{let t=!1;(t=123==e.keyCode||e.ctrlKey&&e.shiftKey&&73==e.keyCode||e.ctrlKey&&e.shiftKey&&74==e.keyCode||e.ctrlKey&&85==e.keyCode?!0:t)&&(document.body.innerHTML="",location.href="about:blank")},document.oncontextmenu=()=>!1,setInterval(()=>{let StartTime=(new Date).getTime(),EndTime=(eval("debugger"),(new Date).getTime());100<EndTime-StartTime&&(document.body.innerHTML="",location.href="about:blank"),(200<outerHeight-innerHeight||200<outerWidth-innerWidth)&&(document.body.innerHTML="",location.href="about:blank")},100)),null==localStorage.getItem("UserScript-Opened")&&(location.href="/index.php?ByUserScript=1"),null!=document.querySelector("#navbar")){if(UtilityEnabled("AutoLogin")&&null!=document.querySelector("#profile")&&"登录"==document.querySelector("#profile").innerHTML&&"/login.php"!=location.pathname&&"/loginpage.php"!=location.pathname&&"/lostpassword.php"!=location.pathname&&(localStorage.setItem("UserScript-LastPage",location.pathname+location.search),location.href="loginpage.php"),8<document.querySelector("#navbar > ul:nth-child(1)").childElementCount&&UtilityEnabled("ACMRank")){let ACMRank=document.createElement("li");document.querySelector("#navbar > ul:nth-child(1)").insertBefore(ACMRank,document.querySelector("#navbar > ul:nth-child(1) > li:nth-child(9)")),ACMRank.innerHTML='<a href="./contestrank-oi.php?cid='+new URLSearchParams(location.search).get("cid")+'&ByUserScript=1">ACM 排名</a>',ACMRank.classList.add("active")}if(UtilityEnabled("Translate")&&(document.querySelector("#navbar > ul:nth-child(1) > li:nth-child(2) > a").innerText="题库"),UtilityEnabled("ReplaceLinks")&&(document.body.innerHTML=String(document.body.innerHTML).replaceAll(/\[<a href="([^"]*)">([^<]*)<\/a>\]/g,'<button onclick="location.href=\'$1\'" class="btn btn-outline-secondary">$2</button>')),UtilityEnabled("ReplaceXM")&&(document.body.innerHTML=String(document.body.innerHTML).replaceAll("小明","高老师"),document.body.innerHTML=String(document.body.innerHTML).replaceAll("下海","上海"),document.body.innerHTML=String(document.body.innerHTML).replaceAll("海上","上海"),document.body.innerHTML=String(document.body.innerHTML).replaceAll("小红","高老师2号"),document.title=String(document.title).replaceAll("小明","高老师")),UtilityEnabled("NewBootstrap")){let Temp=document.querySelectorAll("link");for(var i=0;i<Temp.length;i++)-1!=Temp[i].href.indexOf("bootstrap.min.css")?Temp[i].href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/css/bootstrap.min.css":-1!=Temp[i].href.indexOf("bootstrap-theme.min.css")&&Temp[i].remove();let PopperScriptElement=document.createElement("script"),SentryScriptElement=(document.head.appendChild(PopperScriptElement),PopperScriptElement.type="module",PopperScriptElement.src="https://cdn.bootcdn.net/ajax/libs/popper.js/2.11.7/umd/popper.min.js",document.createElement("script"));document.head.appendChild(SentryScriptElement),SentryScriptElement.src="https://js.sentry-cdn.com/a4c8d48a19954926bf0d8e3d6d6c3024.min.js",Temp=document.querySelectorAll("script");for(var i=0;i<Temp.length;i++)if(-1!=Temp[i].src.indexOf("bootstrap.min.js")){Temp[i].remove();let BootstrapScriptElement=document.createElement("script");document.head.appendChild(BootstrapScriptElement),BootstrapScriptElement.type="module",BootstrapScriptElement.src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/js/bootstrap.min.js"}document.querySelector("nav").className="navbar navbar-expand-lg bg-body-tertiary",document.querySelector("#navbar > ul:nth-child(1)").classList="navbar-nav me-auto mb-2 mb-lg-0",document.querySelector("body > div > nav > div > div.navbar-header").outerHTML='<a class="navbar-brand" href="./">小明的OJ</a><button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-target="#navbar"><span class="navbar-toggler-icon"></span></button>',document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li").classList="nav-item dropdown",document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > a").className="nav-link dropdown-toggle",document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > a > span.caret").remove(),Temp=document.querySelector("#navbar > ul:nth-child(1)").children;for(var i=0;i<Temp.length;i++)Temp[i].classList.contains("active")&&(Temp[i].classList.remove("active"),Temp[i].children[0].classList.add("active")),Temp[i].classList.add("nav-item"),Temp[i].children[0].classList.add("nav-link");document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > a").setAttribute("data-bs-toggle","dropdown"),document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > a").removeAttribute("data-toggle")}UtilityEnabled("RemoveUseless")&&null!=document.getElementsByTagName("marquee")[0]&&document.getElementsByTagName("marquee")[0].remove();let Style=document.createElement("style");if(document.body.appendChild(Style),Style.innerHTML=`
            .status_y:hover {
                box-shadow: #52c41a 1px 1px 10px 0px !important;
            }
            .status_n:hover {
                box-shadow: #fe4c61 1px 1px 10px 0px !important;
            }
            .test-case {
                border-radius: 5px !important;
            }
            .test-case:hover {
                box-shadow: rgba(0, 0, 0, 0.3) 0px 10px 20px 3px !important;
            }
            .software_list {
                width: unset !important;
            }
            .software_item {
                margin: 5px 10px !important;
            }`,UtilityEnabled("AddAnimation")&&(Style.innerHTML+=`.status, .test-case {
                transition: 0.5s !important;
            }`),UtilityEnabled("AddColorText")&&(Style.innerHTML+=`.red {
                color: red !important;
            }
            .green {
                color: green !important;
            }
            .blue {
                color: blue !important;
            }`),"/index.php"==location.pathname||"/"==location.pathname){if(null!=new URL(location.href).searchParams.get("ByUserScript")){localStorage.setItem("UserScript-Opened","true");let Container=document.getElementsByClassName("jumbotron")[0],Alert=(Container.innerHTML="",document.createElement("div")),UtilitiesCard=(Alert.classList.add("alert"),Alert.classList.add("alert-primary"),Alert.role="alert",Alert.innerHTML="欢迎使用XMOJ增强脚本！",Container.appendChild(Alert),document.createElement("div"));UtilitiesCard.classList.add("card"),UtilitiesCard.classList.add("mb-3");{let UtilitiesCardHeader=document.createElement("div"),UtilitiesCardBody=(UtilitiesCardHeader.classList.add("card-header"),UtilitiesCardHeader.innerText="功能列表",UtilitiesCard.appendChild(UtilitiesCardHeader),document.createElement("div"));UtilitiesCardBody.classList.add("card-body");{const CreateList=n=>{var e=document.createElement("ul");e.classList.add("list-group");for(let t=0;t<n.length;t++){var o=document.createElement("li");if(o.classList.add("list-group-item"),"A"==n[t].t?o.classList.add("list-group-item-success"):"F"==n[t].t?o.classList.add("list-group-item-warning"):"D"==n[t].t&&o.classList.add("list-group-item-danger"),null==n[t].o){let e=document.createElement("input");e.classList.add("form-check-input"),e.classList.add("me-1"),e.type="checkbox",e.id=n[t].i,null==localStorage.getItem("UserScript-Setting-"+n[t].i)&&localStorage.setItem("UserScript-Setting-"+n[t].i,"true"),"false"==localStorage.getItem("UserScript-Setting-"+n[t].i)?e.checked=!1:e.checked=!0,e.onchange=()=>{localStorage.setItem("UserScript-Setting-"+n[t].i,e.checked)},o.appendChild(e);var a=document.createElement("label");a.classList.add("form-check-label"),a.htmlFor=n[t].i,a.innerText=n[t].l,o.appendChild(a)}else{a=document.createElement("label");a.innerText=n[t].l,o.appendChild(a)}null!=n[t].o&&o.appendChild(CreateList(n[t].o)),e.appendChild(o)}return e};UtilitiesCardBody.appendChild(CreateList([{i:"ACMRank",t:"A",l:"比赛ACM排名，并且能下载ACM排名"},{i:"MoreSTD",t:"F",l:"查看到更多标程"},{i:"GetOthersSample",t:"A",l:"获取到别人的测试点数据"},{i:"AutoRefresh",t:"A",l:"比赛列表、比赛排名界面自动刷新"},{i:"AutoCountdown",t:"A",l:"比赛列表等界面的时间自动倒计时"},{i:"DownloadPlayback",t:"A",l:"回放视频增加下载功能"},{i:"ImproveACRate",t:"A",l:"自动提交签到提以提高AC率"},{i:"AutoO2",t:"F",l:"代码提交界面自动选择O2优化"},{i:"Beautify",t:"F",l:"美化界面",o:[{i:"NewBootstrap",t:"F",l:"使用新版的Bootstrap样式库*"},{i:"ResetType",t:"F",l:"重新排版*"},{i:"AddColorText",t:"A",l:"增加彩色文字"},{i:"AddUnits",t:"A",l:"状态界面内存与耗时添加单位"},{i:"AddAnimation",t:"A",l:"增加动画"},{i:"ReplaceYN",t:"F",l:"题目前对错的Y和N替换为勾和叉"},{i:"RemoveAlerts",t:"D",l:"去除多余反复的提示"},{i:"Translate",t:"F",l:"统一使用中文，翻译了部分英文*"},{i:"ReplaceLinks",t:"F",l:"将网站中所有以方括号包装的链接替换为按钮"},{i:"RemoveUseless",t:"D",l:"删去无法使用的功能*"},{i:"ReplaceXM",t:"F",l:"将网站中所有“小明”关键字替换为“高老师”，所有“小红”关键字替换为“高老师2号”，所有“下海”、“海上”替换为“上海”"}]},{i:"AutoLogin",t:"A",l:"在需要登录的界面自动跳转到登陆界面"},{i:"SavePassword",t:"A",l:"自动保存用户名与密码，免去每次手动输入密码的繁琐"},{i:"CopySamples",t:"F",l:"题目界面测试样例有时复制无效"},{i:"RefreshSolution",t:"F",l:"状态页面结果自动刷新每次只能刷新一个"},{i:"CopyMD",t:"A",l:"复制题目内容"},{i:"OpenAllProblem",t:"A",l:"比赛题目界面一键打开所有题目"},{i:"CheckCode",t:"A",l:"提交代码前对代码进行检查",o:[{i:"IOFile",t:"A",l:"是否使用了文件输入输出（如果需要使用）"},{i:"CompileError",t:"A",l:"是否有编译错误"}]},{i:"ExportACCode",t:"F",l:"导出AC代码每一道题目一个文件"},{i:"LoginFailed",t:"F",l:"登录后跳转失败*"},{i:"NewDownload",t:"A",l:"下载页面增加下载内容"},{i:"CompareSource",t:"A",l:"比较代码"}]));let UtilitiesCardFooter=document.createElement("div");UtilitiesCardFooter.className="card-footer text-muted",UtilitiesCardFooter.innerText="* 不建议关闭，可能会导致系统不稳定、界面错乱、功能缺失等问题\n绿色：增加功能　黄色：修改功能　红色：删除功能",UtilitiesCardBody.appendChild(UtilitiesCardFooter)}UtilitiesCard.appendChild(UtilitiesCardBody)}Container.appendChild(UtilitiesCard);let FeedbackCard=document.createElement("div");FeedbackCard.className="card mb-3";{let FeedbackCardHeader=document.createElement("div"),FeedbackCardBody=(FeedbackCardHeader.className="card-header",FeedbackCardHeader.innerText="反馈、源代码、联系作者",FeedbackCard.appendChild(FeedbackCardHeader),document.createElement("div"));FeedbackCardBody.className="card-body";{let FeedbackCardText=document.createElement("p"),FeedbackCardLink=(FeedbackCardText.className="card-text",FeedbackCardText.innerText="如果您有任何建议或者发现了bug，请前往本项目的GitHub页面并提交issue。提交issue前请先搜索是否有相同的issue，如果有请在该issue下留言。请在issue中尽可能详细地描述您的问题，并且附上您的浏览器版本、操作系统版本、脚本版本、复现步骤等信息。谢谢您支持本项目。",FeedbackCardBody.appendChild(FeedbackCardText),document.createElement("a"));FeedbackCardLink.className="card-link",FeedbackCardLink.innerText="GitHub",FeedbackCardLink.href="https://github.com/langningchen/XMOJ-Script",FeedbackCardBody.appendChild(FeedbackCardLink)}FeedbackCard.appendChild(FeedbackCardBody)}Container.appendChild(FeedbackCard)}}else if("/problemset.php"==location.pathname){UtilityEnabled("Translate")&&(document.querySelector("body > div > div > center > table:nth-child(2) > tbody > tr > td:nth-child(2) > form > input").placeholder="题目编号",document.querySelector("body > div > div > center > table:nth-child(2) > tbody > tr > td:nth-child(2) > form > button").innerText="确认",document.querySelector("body > div > div > center > table:nth-child(2) > tbody > tr > td:nth-child(3) > form > input").placeholder="标题或内容",document.querySelector("#problemset > thead > tr > th:nth-child(1)").innerText="状态"),UtilityEnabled("ResetType")&&(document.querySelector("#problemset > thead > tr > th:nth-child(1)").style.width="5%",document.querySelector("#problemset > thead > tr > th:nth-child(2)").style.width="10%",document.querySelector("#problemset > thead > tr > th:nth-child(3)").style.width="75%",document.querySelector("#problemset > thead > tr > th:nth-child(4)").style.width="5%",document.querySelector("#problemset > thead > tr > th:nth-child(5)").style.width="5%"),document.querySelector("body > div > div > center > table:nth-child(2)").innerHTML="";let Temp=document.querySelector("#problemset").rows;for(let i=1;i<Temp.length;i++)localStorage.setItem("UserScript-Problem-"+Temp[i].children[1].innerText+"-Name",Temp[i].children[2].innerText)}else if("/problem.php"==location.pathname){null!=new URLSearchParams(location.search).get("cid")&&(document.getElementsByTagName("h2")[0].innerHTML+=" ("+localStorage.getItem("UserScript-Contest-"+new URLSearchParams(location.search).get("cid")+"-Problem-"+new URLSearchParams(location.search).get("pid")+"-PID")+")"),document.querySelector("body > div > div > center").lastChild.style.marginLeft="10px",Temp=document.querySelectorAll(".sampledata");for(var i=0;i<Temp.length;i++)Temp[i].parentElement.className="card";UtilityEnabled("RemoveUseless")&&document.getElementsByTagName("center")[1].remove(),UtilityEnabled("CopySamples")&&$(".copy-btn").click(e=>{var e=$(e.currentTarget),t=e.parent().last().find(".sampledata");t.length?(CopyToClipboard(t.text()),e.text("复制成功").addClass("done"),setTimeout(()=>{$(".copy-btn").text("复制").removeClass("done")},1e3),document.body.removeChild(textarea[0])):(e.text("未找到pre").addClass("done"),setTimeout(()=>{$(".copy-btn").text("复制").removeClass("done")},1e3))});let IOFileElement=document.querySelector("body > div > div > center > h3");if(null!=IOFileElement){for(;1<=IOFileElement.childNodes.length;)IOFileElement.parentNode.insertBefore(IOFileElement.childNodes[0],IOFileElement);IOFileElement.parentNode.insertBefore(document.createElement("br"),IOFileElement),IOFileElement.remove();let Temp=document.querySelector("body > div > div > center").childNodes[2].data.trim(),IOFilename=Temp.substring(0,Temp.length-3),SearchParams=new URLSearchParams(location.search),PID=0;null!=SearchParams.get("id")?PID=SearchParams.get("id"):null!=SearchParams.get("cid")&&null!=SearchParams.get("pid")&&(PID=localStorage.getItem("UserScript-Contest-"+SearchParams.get("cid")+"-Problem-"+SearchParams.get("pid")+"-PID")),localStorage.setItem("UserScript-Problem-"+PID+"-IOFilename",IOFilename)}UtilityEnabled("CopyMD")&&await fetch(location.href).then(e=>e.text()).then(e=>{let n=(new DOMParser).parseFromString(e,"text/html").querySelectorAll(".cnt-row");for(let t=0;t<n.length;t++)if("content"==n[t].children[1].children[0].className){let e=document.createElement("button");e.className="btn btn-sm btn-outline-secondary copy-btn",e.innerText="复制",e.style.marginLeft="10px",e.type="button",document.querySelectorAll(".cnt-row")[t].children[0].appendChild(e),e.onclick=()=>{CopyToClipboard(n[t].children[1].children[0].innerText.trim().replaceAll("\n\t","\n").replaceAll("\n\n","\n").replaceAll("\n\n","\n")),e.innerText="复制成功",setTimeout(()=>{e.innerText="复制"},1e3)}}})}else if("/status.php"==location.pathname)if(null==new URL(location.href).searchParams.get("ByUserScript")){if(UtilityEnabled("NewBootstrap")&&(document.querySelector("#simform").outerHTML=`<form id="simform" class="justify-content-center form-inline row g-2" action="status.php" method="get" style="padding-bottom: 7px;">
            <input class="form-control" type="text" size="4" name="user_id" value="`+document.getElementById("profile").innerText+`" style="display: none;">
            <div class="col-md-1">
                <label for="problem_id" class="form-label">题目编号</label>
                <input type="text" class="form-control" id="problem_id" name="problem_id" size="4">
            </div>
            <div class="col-md-1">
                <label for="language" class="form-label">语言</label>
                <select id="language" name="language" class="form-select">
                    <option value="-1" selected="">全部</option>
                    <option value="0">C</option>
                    <option value="1">C++</option>
                    <option value="2">Pascal</option>
                </select>
            </div><div class="col-md-1">
                <label for="jresult" class="form-label">结果</label>
                <select id="jresult" name="jresult" class="form-select">
                    <option value="-1" selected="">全部</option>
                    <option value="4">正确</option>
                    <option value="5">格式错误</option>
                    <option value="6">答案错误</option>
                    <option value="7">时间超限</option>
                    <option value="8">内存超限</option>
                    <option value="9">输出超限</option>
                    <option value="10">运行错误</option>
                    <option value="11">编译错误</option>
                    <option value="0">等待</option>
                    <option value="1">等待重判</option>
                    <option value="2">编译中</option>
                    <option value="3">运行并评判</option>
                </select>
            </div>
            <div class="col-md-1">
                <button type="submit" class="btn btn-primary">查找</button>
            </div><div id="csrf"></div></form>`),UtilityEnabled("GetOthersSample")){let GetOthersSampleButton=document.createElement("button");document.querySelector("body > div.container > div > div.input-append").appendChild(GetOthersSampleButton),GetOthersSampleButton.className="btn btn-outline-secondary",GetOthersSampleButton.innerText="获取他人样例",GetOthersSampleButton.onclick=()=>{location.href="status.php?ByUserScript=1"},GetOthersSampleButton.style.marginBottom=GetOthersSampleButton.style.marginRight="7px",GetOthersSampleButton.style.marginRight="7px"}if(UtilityEnabled("ImproveACRate")){let ImproveACRateButton=document.createElement("button");document.querySelector("body > div.container > div > div.input-append").appendChild(ImproveACRateButton),ImproveACRateButton.className="btn btn-outline-secondary",ImproveACRateButton.innerText="提高AC率",await fetch("http://www.xmoj.tech/userinfo.php?user="+document.getElementById("profile").innerText).then(e=>e.text()).then(e=>{e=(new DOMParser).parseFromString(e,"text/html");ImproveACRateButton.innerText+="("+(parseInt(e.querySelector("#statics > tbody > tr:nth-child(4) > td:nth-child(2)").innerText)/parseInt(e.querySelector("#statics > tbody > tr:nth-child(3) > td:nth-child(2)").innerText)*100).toFixed(2)+"%)"}),ImproveACRateButton.onclick=async()=>{ImproveACRateButton.disabled=!0,await fetch("http://www.xmoj.tech/csrf.php").then(e=>e.text()).then(e=>{CSRF=(new DOMParser).parseFromString(e,"text/html").querySelector("input[name=csrf]").value});let e=0;let t=setInterval(async()=>{3<=e?(clearInterval(t),location.reload()):(e++,ImproveACRateButton.innerText="正在提交 ("+e+"/3)",await fetch("http://www.xmoj.tech/submit.php",{headers:{m:"application/x-www-form-urlencoded"},referrer:"http://www.xmoj.tech/submitpage.php?id=2298",method:"POST",body:"id=2298&language=1&source=%23include+%3Cbits%2Fstdc%2B%2B.h%3E%0D%0Ausing+namespace+std%3B%0D%0Aint+main%28%29%0D%0A%7B%0D%0A++++printf%28%220%5Cn%22%29%3B%0D%0A++++return+0%3B%0D%0A%7D%0D%0A&enable_O2=on"}))},1e3)},ImproveACRateButton.style.marginBottom=ImproveACRateButton.style.marginRight="7px",ImproveACRateButton.style.marginRight="7px"}if(UtilityEnabled("CompareSource")){let CompareButton=document.createElement("button");document.querySelector("body > div.container > div > div.input-append").appendChild(CompareButton),CompareButton.className="btn btn-outline-secondary",CompareButton.innerText="比较提交记录",CompareButton.onclick=()=>{location.href="comparesource.php"},CompareButton.style.marginBottom="7px"}UtilityEnabled("ResetType")&&(document.querySelector("#result-tab > thead > tr > th:nth-child(1)").remove(),document.querySelector("#result-tab > thead > tr > th:nth-child(2)").remove(),document.querySelector("#result-tab > thead > tr > th:nth-child(9)").remove(),document.querySelector("#result-tab > thead > tr > th:nth-child(9)").remove());let Temp=document.querySelector("#result-tab > tbody").childNodes;for(let i=1;i<Temp.length;i+=2)UtilityEnabled("ResetType")&&(Temp[i].childNodes[0].remove(),Temp[i].childNodes[0].innerHTML='<a href="showsource.php?id='+Temp[i].childNodes[0].innerText+'">'+Temp[i].childNodes[0].innerText+"</a>",Temp[i].childNodes[1].remove(),Temp[i].childNodes[1].children[0].removeAttribute("class"),Temp[i].childNodes[3].childNodes[0].innerText=SizeToStringSize(Temp[i].childNodes[3].childNodes[0].innerText),Temp[i].childNodes[4].childNodes[0].innerText=TimeToStringTime(Temp[i].childNodes[4].childNodes[0].innerText),Temp[i].childNodes[5].innerText=Temp[i].childNodes[5].childNodes[0].innerText,Temp[i].childNodes[6].innerText=SizeToStringSize(Temp[i].childNodes[6].innerText.substring(0,Temp[i].childNodes[6].innerText.length-1)),Temp[i].childNodes[8].remove(),Temp[i].childNodes[8].remove()),null==new URLSearchParams(location.search).get("cid")?localStorage.setItem("UserScript-Solution-"+Temp[i].childNodes[0].innerText+"-Problem",Temp[i].childNodes[1].innerText):(localStorage.setItem("UserScript-Solution-"+Temp[i].childNodes[0].innerText+"-Contest",new URLSearchParams(location.search).get("cid")),localStorage.setItem("UserScript-Solution-"+Temp[i].childNodes[0].innerText+"-PID-Contest",Temp[i].childNodes[1].innerText.charAt(0)));if(UtilityEnabled("ResetType")&&(document.querySelector("#result-tab > thead > tr > th:nth-child(1)").style.width="10%",document.querySelector("#result-tab > thead > tr > th:nth-child(2)").style.width="10%",document.querySelector("#result-tab > thead > tr > th:nth-child(3)").style.width="20%",document.querySelector("#result-tab > thead > tr > th:nth-child(4)").style.width="10%",document.querySelector("#result-tab > thead > tr > th:nth-child(5)").style.width="10%",document.querySelector("#result-tab > thead > tr > th:nth-child(6)").style.width="10%",document.querySelector("#result-tab > thead > tr > th:nth-child(7)").style.width="10%",document.querySelector("#result-tab > thead > tr > th:nth-child(8)").style.width="20%"),UtilityEnabled("RefreshSolution")){let Rows=document.getElementById("result-tab").rows,Points=Array();for(let i=Rows.length-1;0<i;i--){Rows[i].cells[2].className="td_result";let SolutionID=Rows[i].cells[0].innerText;2==Rows[i].cells[2].children.length&&(Points[SolutionID]=Rows[i].cells[2].children[1].innerText,Rows[i].cells[2].children[1].remove()),Rows[i].cells[2].innerHTML+='<img style="margin-left: 10px" height="18" width="18" src="image/loader.gif">',setTimeout(()=>{RefreshResult(SolutionID)},0)}let RefreshResult=async n=>{let o=null;var t=document.getElementById("result-tab").rows;for(let e=1;e<t.length;e++)if(t[e].cells[0].innerText==n){o=t[e];break}await fetch("status-ajax.php?solution_id="+n).then(e=>e.text()).then(e=>{e=e.split(",");o.cells[3].innerHTML='<div id="center" class="red">'+SizeToStringSize(e[1])+"</div>",o.cells[4].innerHTML='<div id="center" class="red">'+TimeToStringTime(e[2])+"</div>";let t='<a href="'+(11==e[0]?"ce":"re")+"info.php?sid="+n+'" class="'+judge_color[e[0]]+'">';t=t+judge_result[e[0]]+"</a>",null!=Points[n]&&(t+='<span style="margin-left: 5px" class="badge text-bg-info">'+Points[n]+"</span>"),e[0]<4&&(setTimeout(()=>{RefreshResult(n)},500),t+='<img style="margin-left: 5px" height="18" width="18" src="image/loader.gif">'),o.cells[2].innerHTML=t})}}}else UtilityEnabled("GetOthersSample")&&(document.querySelector(".jumbotron").innerHTML=`<div class="jumbotron">
        <div class="row g-3 align-items-center mb-2">
        <div class="col-auto">
            <label for="NameInput" class="col-form-label">测试点获取人姓名的拼音</label>
        </div>
        <div class="col-auto">
            <input type="text" id="NameInput" class="form-control" value="`+document.getElementById("profile").innerText+`">
        </div>
        </div>
        <div class="row g-3 align-items-center mb-2">
        <div class="col-auto">
            <label for="DateInput" class="col-form-label">测试点获取的日期</label>
        </div>
        <div class="col-auto">
            <input type="date" id="DateInput" class="form-control" value="`+(new Date).toISOString().slice(0,10)+`">
        </div>
        </div>
        <div class="row g-3 align-items-center mb-2">
        <div class="col-auto">
            <label for="ProblemInput" class="col-form-label">获取测试点的题目ID</label>
        </div>
        <div class="col-auto">
            <input type="number" id="ProblemInput" class="form-control">
        </div>
        </div>
        <div class="row g-3 align-items-center mb-2">
        <div class="col-auto">
            <label for="SID" class="col-form-label">获取测试点的提交ID</label>
        </div>
        <div class="col-auto">
            <input type="number" id="SID" class="form-control">
        </div>
        </div>
        <div class="row g-3 align-items-center mb-2">
        <div class="col-auto">
            <label for="SampleInput" class="col-form-label">获取的测试点编号</label>
        </div>
        <div class="col-auto">
            <input type="number" id="SampleInput" class="form-control">
        </div>
        </div>
        <button type="submit" class="btn btn-primary mb-3" id="GetSample">获取</button>
        <div role="alert" id="GetSampleAlert" style="display: none"></div>
    </div>`,document.getElementById("GetSample").onclick=async()=>{document.getElementById("GetSampleAlert").style.display="none";let n=document.getElementById("NameInput").value,t=document.getElementById("DateInput").value.replaceAll("-",""),o=document.getElementById("ProblemInput").value,a=document.getElementById("SID").value,i=document.getElementById("SampleInput").value;""==n||""==t||""==a||""==i?(document.getElementById("GetSampleAlert").classList="alert alert-danger",document.getElementById("GetSampleAlert").innerText="请填写完整信息",document.getElementById("GetSampleAlert").style.display="block"):t<(new Date).toISOString().slice(0,10).replaceAll("-","")-7?(document.getElementById("GetSampleAlert").classList="alert alert-danger",document.getElementById("GetSampleAlert").innerText="只能获取7天内的测试点",document.getElementById("GetSampleAlert").style.display="block"):await fetch("http://www.xmoj.tech/userinfo.php?user="+n).then(e=>e.text()).then(async e=>{-1!=e.indexOf("No such User")?(document.getElementById("GetSampleAlert").classList="alert alert-danger",document.getElementById("GetSampleAlert").innerText="用户不存在",document.getElementById("GetSampleAlert").style.display="block"):await fetch("http://www.xmoj.tech/data_down/"+t+"/"+n+"_"+a+"_"+(null==localStorage.getItem("UserScript-Problem-"+o+"-IOFilename")?"":localStorage.getItem("UserScript-Problem-"+o+"-IOFilename"))+i+".zip").then(e=>{if(404!=e.status)return e.blob();document.getElementById("GetSampleAlert").classList="alert alert-danger",document.getElementById("GetSampleAlert").innerText="无此测试点",document.getElementById("GetSampleAlert").style.display="block"}).then(e=>{var t;null!=e&&(document.getElementById("GetSampleAlert").classList="alert alert-success",document.getElementById("GetSampleAlert").innerText="获取成功",document.getElementById("GetSampleAlert").style.display="block",(t=document.createElement("a")).href=window.URL.createObjectURL(e),t.download=n+"_"+a+"_"+i+".zip",t.click())})})});else if("/contest.php"==location.pathname)if(UtilityEnabled("AutoCountdown")&&(clock=()=>{setInterval(()=>{var e=new Date((new Date).getTime()+diff);let t=e.getFullYear();3e3<t&&(t-=1900);var n=e.getMonth()+1,o=e.getDate(),a=e.getHours(),i=e.getMinutes(),e=e.getSeconds();document.getElementById("nowdate").innerHTML=t+"-"+(n<10?"0":"")+n+"-"+(o<10?"0":"")+o+" "+(a<10?"0":"")+a+":"+(i<10?"0":"")+i+":"+(e<10?"0":"")+e},200)}),-1==location.href.indexOf("?cid=")){UtilityEnabled("ResetType")&&(document.querySelector("body > div > div > center").innerHTML=String(document.querySelector("body > div > div > center").innerHTML).replaceAll("ServerTime:","服务器时间："),document.querySelector("body > div > div > center > table").style.marginTop="10px",document.querySelector("body > div > div > center > form").childNodes[0].data="",document.querySelector("body > div > div > center > form > input[type=text]:nth-child(1)").className="form-control",document.querySelector("body > div > div > center > form > input[type=text]:nth-child(1)").style.width="200px",document.querySelector("body > div > div > center > form > input[type=text]:nth-child(1)").style.display="inline-block",document.querySelector("body > div > div > center > form > input[type=submit]:nth-child(2)").value="搜索",document.querySelector("body > div > div > center > form > input[type=submit]:nth-child(2)").className="form-control",document.querySelector("body > div > div > center > form > input[type=submit]:nth-child(2)").style.width="unset",document.querySelector("body > div > div > center > form > input[type=submit]:nth-child(2)").style.display="inline-block"),UtilityEnabled("Translate")&&(document.querySelector("body > div > div > center > table > thead > tr").childNodes[0].innerText="编号",document.querySelector("body > div > div > center > table > thead > tr").childNodes[1].innerText="标题",document.querySelector("body > div > div > center > table > thead > tr").childNodes[2].innerText="状态",document.querySelector("body > div > div > center > table > thead > tr").childNodes[3].remove(),document.querySelector("body > div > div > center > table > thead > tr").childNodes[3].innerText="创建者");let Temp=document.querySelector("body > div > div > center > table > tbody").childNodes;for(let i=1;i<Temp.length;i++){let CurrentElement=Temp[i].childNodes[2].childNodes;if(-1!=CurrentElement[1].childNodes[0].data.indexOf("运行中")){let Time=String(CurrentElement[1].childNodes[1].innerText).substring(4),Day=parseInt(Time.substring(0,Time.indexOf("天")))||0,Hour=parseInt(Time.substring(Math.max(0,Time.indexOf("天")+1),Time.indexOf("小时")))||0,Minute=parseInt(Time.substring(Math.max(0,Time.indexOf("小时")+2),Time.indexOf("分")))||0,Second=parseInt(Time.substring(Math.max(0,Time.indexOf("分")+1),Time.indexOf("秒")))||0,TimeStamp=(new Date).getTime()+diff+1e3*(60*(60*(24*(isNaN(Day)?0:Day)+Hour)+Minute)+Second);CurrentElement[1].childNodes[1].setAttribute("EndTime",TimeStamp),CurrentElement[1].childNodes[1].classList.add("UpdateByJS")}else if(-1!=CurrentElement[1].childNodes[0].data.indexOf("开始于")){let TimeStamp=Date.parse(String(CurrentElement[1].childNodes[0].data).substring(4))-diff;CurrentElement[1].setAttribute("EndTime",TimeStamp),CurrentElement[1].classList.add("UpdateByJS")}else if(-1!=CurrentElement[1].childNodes[0].data.indexOf("已结束")){let TimeStamp=String(CurrentElement[1].childNodes[0].data).substring(4),Temp=(CurrentElement[1].childNodes[0].data=" 已结束 ",CurrentElement[1].className="red",document.createElement("span"));CurrentElement[1].appendChild(Temp),Temp.className="green",Temp.innerHTML=TimeStamp}Temp[i].childNodes[3].style.display="none",Temp[i].childNodes[4].innerHTML='<a href="userinfo.php?user='+Temp[i].childNodes[4].innerHTML+'">'+Temp[i].childNodes[4].innerHTML+"</a>",localStorage.setItem("UserScript-Contest-"+Temp[i].childNodes[0].innerText+"-Name",Temp[i].childNodes[1].innerText)}}else{if(document.getElementsByTagName("h3")[0].innerHTML="比赛"+document.getElementsByTagName("h3")[0].innerHTML.substring(7),null!=document.querySelector("#time_left")){let EndTime=document.querySelector("body > div > div > center").childNodes[3].data;EndTime=EndTime.substring(EndTime.indexOf("结束时间是：")+6,EndTime.lastIndexOf("。")),EndTime=new Date(EndTime).getTime(),(new Date).getTime()<EndTime&&(document.querySelector("#time_left").classList.add("UpdateByJS"),document.querySelector("#time_left").setAttribute("EndTime",EndTime))}let HTMLData=document.querySelector("body > div > div > center > div").innerHTML;if(HTMLData=HTMLData.replaceAll("&nbsp;&nbsp;\n&nbsp;&nbsp;","&nbsp;"),HTMLData=HTMLData.replaceAll("<br>开始于: ","开始时间："),HTMLData=HTMLData.replaceAll("\n结束于: ","<br>结束时间："),HTMLData=HTMLData.replaceAll("\n订正截止日期: ","<br>订正截止日期："),HTMLData=HTMLData.replaceAll("\n现在时间: ","当前时间："),HTMLData=HTMLData.replaceAll("\n状态:","<br>状态："),document.querySelector("body > div > div > center > div").innerHTML=HTMLData,UtilityEnabled("RemoveAlerts")&&-1!=document.querySelector("body > div > div > center").innerHTML.indexOf("尚未开始比赛"))document.querySelector("body > div > div > center > a").setAttribute("href","start_contest.php?cid="+new URLSearchParams(location.search).get("cid"));else if(UtilityEnabled("AutoRefresh")){onfocus=async()=>{await fetch(location.href).then(e=>e.text()).then(e=>{var t=(new DOMParser).parseFromString(e,"text/html").querySelector("#problemset > tbody").children;if(UtilityEnabled("ReplaceYN"))for(let e=0;e<t.length;e++){var n=t[e].children[0].innerText;-1!=n.indexOf("Y")?(document.querySelector("#problemset > tbody").children[e].children[0].children[0].className="status status_y",document.querySelector("#problemset > tbody").children[e].children[0].children[0].innerText="✓"):-1!=n.indexOf("N")&&(document.querySelector("#problemset > tbody").children[e].children[0].children[0].className="status status_n",document.querySelector("#problemset > tbody").children[e].children[0].children[0].innerText="✗")}})},document.querySelector("body > div > div > center > br:nth-child(2)").remove(),document.querySelector("body > div > div > center > br:nth-child(2)").remove(),document.querySelector("body > div > div > center > div > .red").innerHTML=String(document.querySelector("body > div > div > center > div > .red").innerHTML).replaceAll("<br>","<br><br>");let StaticButton=document.createElement("button");if(document.querySelectorAll("body > div > div > center > div > .red")[1].appendChild(StaticButton),StaticButton.className="btn btn-outline-secondary",StaticButton.innerText="统计",StaticButton.onclick=()=>{location.href="/conteststatistics.php?cid="+new URLSearchParams(location.search).get("cid")},document.querySelector("#problemset > tbody").innerHTML=String(document.querySelector("#problemset > tbody").innerHTML).replaceAll(/\t&nbsp;([0-9]*) &nbsp;&nbsp;&nbsp;&nbsp; 问题 &nbsp;([^<]*)/g,"$2. $1"),document.querySelector("#problemset > tbody").innerHTML=String(document.querySelector("#problemset > tbody").innerHTML).replaceAll(/\t\*([0-9]*) &nbsp;&nbsp;&nbsp;&nbsp; 问题 &nbsp;([^<]*)/g,"拓展$2. $1"),UtilityEnabled("MoreSTD")&&-1!=document.querySelector("#problemset > thead > tr").innerHTML.indexOf("标程")){let Temp=document.querySelector("#problemset > thead > tr").children;for(let i=0;i<Temp.length;i++)if("标程"==Temp[i].innerText){Temp[i].remove();let Temp2=document.querySelector("#problemset > tbody").children;for(let j=0;j<Temp2.length;j++)null!=Temp2[j].children[i]&&Temp2[j].children[i].remove()}document.querySelector("#problemset > thead > tr").innerHTML+='<td width="5%">标程</td>',Temp=document.querySelector("#problemset > tbody").children;for(let i=0;i<Temp.length;i++)Temp[i].innerHTML+='<td><a href="problem_std.php?cid='+new URLSearchParams(location.search).get("cid")+"&pid="+i+'" target="_blank">打开</a></td>'}Temp=document.querySelector("#problemset > tbody").rows;for(let i=0;i<Temp.length;i++){0==Temp[i].childNodes[0].children.length&&(Temp[i].childNodes[0].innerHTML='<div class="status"></div>');let PID=Temp[i].childNodes[1].innerHTML;"拓展"==PID.substring(0,2)&&(PID=PID.substring(2)),Temp[i].children[2].children[0].target="_blank",localStorage.setItem("UserScript-Contest-"+new URLSearchParams(location.search).get("cid")+"-Problem-"+i+"-PID",PID.substring(3)),localStorage.setItem("UserScript-Problem-"+PID.substring(3)+"-Name",Temp[i].childNodes[2].innerText)}if(UtilityEnabled("ResetType")&&(document.querySelector("#problemset > thead > tr > td:nth-child(1)").innerText="状态",document.querySelector("#problemset").style.marginTop="10px"),UtilityEnabled("OpenAllProblem")){let OpenAllDiv=document.createElement("div"),OpenAllButton=(OpenAllDiv.style.marginTop="20px",OpenAllDiv.style.textAlign="left",document.querySelector("body > div > div > center").insertBefore(OpenAllDiv,document.querySelector("#problemset")),document.createElement("button")),OpenUnsolvedButton=(OpenAllButton.className="btn btn-outline-secondary",OpenAllButton.innerText="打开全部题目",OpenAllButton.style.marginRight="5px",OpenAllDiv.appendChild(OpenAllButton),OpenAllButton.onclick=()=>{var t=document.querySelector("#problemset > tbody").rows;for(let e=0;e<t.length;e++)open(t[e].children[2].children[0].href,"_blank")},document.createElement("button"));OpenUnsolvedButton.className="btn btn-outline-secondary",OpenUnsolvedButton.innerText="打开未解决题目",OpenAllDiv.appendChild(OpenUnsolvedButton),OpenUnsolvedButton.onclick=()=>{var t=document.querySelector("#problemset > tbody").rows;for(let e=0;e<t.length;e++)t[e].children[0].children[0].classList.contains("status_y")||open(t[e].children[2].children[0].href,"_blank")}}UtilityEnabled("ResetType")&&(document.querySelector("#problemset > thead > tr > td:nth-child(1)").style.width="5%"),localStorage.setItem("UserScript-Contest-"+new URLSearchParams(location.search).get("cid")+"-ProblemCount",document.querySelector("#problemset > tbody").rows.length)}}else if("/contestrank-oi.php"==location.pathname){if(null==document.querySelector("#rank")&&(document.querySelector("body > div > div").innerHTML='<center><h3>比赛排名</h3><a></a><table id="rank"></table>'),null==new URL(location.href).searchParams.get("ByUserScript"))"比赛排名"==document.querySelector("body > div > div > center > h3").innerText?document.querySelector("#rank").innerText="比赛暂时还没有排名":(document.querySelector("body > div > div > center > h3").innerText=document.querySelector("body > div > div > center > h3").innerText.substring(document.querySelector("body > div > div > center > h3").innerText.indexOf(" -- ")+4)+"（OI排名）",document.querySelector("#rank > thead > tr > :nth-child(1)").innerText="排名",document.querySelector("#rank > thead > tr > :nth-child(2)").innerText="用户",document.querySelector("#rank > thead > tr > :nth-child(3)").innerText="昵称",document.querySelector("#rank > thead > tr > :nth-child(4)").innerText="AC数",document.querySelector("#rank > thead > tr > :nth-child(5)").innerText="得分",onfocus=async()=>{await fetch(location.href).then(e=>e.text()).then(e=>{for(var e=(new DOMParser).parseFromString(e,"text/html"),t=(TidyTable(e.getElementById("rank")),e.getElementById("rank").rows),n=1;n<t.length;n++){var o=t[n].cells[0],a=document.createElement("span");a.innerText=o.innerText,a.className="badge text-bg-primary",o.innerText="",o.appendChild(a),t[n].cells[1].children[0].className="link-primary link-offset-2 link-underline-opacity-50",t[n].cells[1].children[0].target="_blank",t[n].cells[2].innerHTML=t[n].cells[2].innerText,t[n].cells[3].innerHTML=t[n].cells[3].innerText}document.querySelector("#rank > tbody").innerHTML=e.querySelector("#rank > tbody").innerHTML})},onfocus(),UtilityEnabled("AutoRefresh")||(onfocus=null));else if(UtilityEnabled("ACMRank")){"比赛排名"!=document.querySelector("body > div > div > center > h3").innerText&&(document.querySelector("body > div > div > center > h3").innerText=document.querySelector("body > div > div > center > h3").innerText.substring(document.querySelector("body > div > div > center > h3").innerText.indexOf(" -- ")+4)+"（ACM排名）");let RankData=[],ReloadRank=async T=>{let C=scrollX,w=scrollY;var e=new URL(location.href);e.pathname="/contestrank2.php",await fetch(e.toString()).then(e=>e.text()).then(e=>{RankData=[];var t=document.querySelector("#rank"),n=(t.innerHTML="",e.indexOf("var solutions=")+14),o=e.indexOf("}];",n)+2;if(1==o)t.innerHTML="暂时还没有人提交";else{var a=JSON.parse(e.substring(n,o));for(let o=0;o<a.length;o++){let t=a[o],e=RankData.find(e=>{if(e.u==t.user_id)return!0}),n=(null==e&&(e={u:t.user_id,p:t.nick,h:0,v:0,g:[]},RankData.push(e)),e.g.find(e=>{if(e.S==t.num)return!0}));null==n&&(n={S:t.num,T:[],C:0},e.g.push(n)),4==t.result&&0==n.C&&(n.C=parseInt(t.in_date),e.h++,e.v+=parseInt(t.in_date)+20*n.T.length*60),n.T.push({U:t.in_date,D:t.result})}RankData.sort((e,t)=>e.h!=t.h?e.h<t.h?1:-1:e.v!=t.v?e.v>t.v?1:-1:0);var e=document.createElement("thead"),i=(t.appendChild(e),document.createElement("tr")),n=(e.appendChild(i),document.createElement("th")),o=(i.appendChild(n),n.innerText="排名",n.style.width="5%",document.createElement("th")),e=(i.appendChild(o),o.innerText="用户",o.style.width="10%",document.createElement("th")),n=(i.appendChild(e),e.innerText="昵称",e.style.width="10%",document.createElement("th")),o=(i.appendChild(n),n.innerText="姓名",n.style.width="5%",document.createElement("th")),e=(i.appendChild(o),o.innerText="AC数",o.style.width="5%",document.createElement("th"));i.appendChild(e),e.innerText="罚时",e.style.width="10%";for(let e=0;e<T;e++){var r=document.createElement("th"),l=(i.appendChild(r),document.createElement("a"));r.appendChild(l),l.href="problem.php?cid="+new URLSearchParams(location.search).get("cid")+"&pid="+e,l.innerText=String.fromCharCode(65+e),r.classList.add("header"),r.style.width=50/T+"%"}var d=document.createElement("tbody");t.appendChild(d),d.className="table-group-divider";for(let e=0;e<RankData.length;e++){var c=RankData[e],m=document.createElement("tr"),s=(d.appendChild(m),document.createElement("td")),u=(m.appendChild(s),document.createElement("td")),p=(m.appendChild(u),document.createElement("td")),b=(m.appendChild(p),document.createElement("td")),h=(m.appendChild(b),document.createElement("td")),v=(m.appendChild(h),document.createElement("td")),y=(m.appendChild(v),document.createElement("span")),s=(s.appendChild(y),y.innerText=e+1,y.classList.add("badge"),e<=.05*RankData.length?y.classList.add("text-bg-danger"):e<=.15*RankData.length?y.classList.add("text-bg-warning"):e<=.4*RankData.length?y.classList.add("text-bg-primary"):y.classList.add("text-bg-secondary"),document.createElement("a")),y=(u.appendChild(s),s.href="userinfo.php?user="+c.u,s.innerText=c.u,s.className="link-primary link-offset-2 link-underline-opacity-50",c.u==document.getElementById("profile").innerText&&m.classList.add("table-primary"),p.innerText=c.p.length<16?c.p:c.p.substring(0,15)+"...",{k:"陈朗宁",I:"陈斯如",R:"陈天乐",A:"陈宣合",P:"陈泽聪",B:"陈泽睿",L:"单文骁",O:"董明辉",M:"高晨茗",N:"郭庆桐",j:"郭睿群",_:"顾毓辰",F:"韩书简",G:"贺书瀚",H:"何昕弈",J:"黄铭宣",V:"黄睿纳",q:"黄唯",$:"胡以杨",X:"姜星宇",Y:"荆泰宇",W:"金炜喆",K:"雷家涵",Z:"连中哲",ee:"廖彦旭",te:"凌梓翔",ne:"林子懿",oe:"刘健豪",ae:"刘健坤",ie:"刘先勇",re:"刘希贤",le:"李亦涵",de:"罗金阳",ce:"陆天枫",me:"梅天一",se:"潘胤良",ue:"彭议萱",pe:"蒲通",be:"钱清源",he:"戚得凯",ve:"单文骁",ye:"沈熙晨",ge:"施泓熙",fe:"施慕梵",Se:"施奕辰",Te:"施云浩",Ce:"舒馨墨",we:"隋若宸",Ee:"孙艺涵",Ue:"孙义淼",xe:"唐潮",De:"唐钰涵",ke:"谭皓轩",Ie:"陶羡榆",Re:"王康明",Ae:"王明浩",Pe:"王茗铄",Be:"王芃雨",Le:"王思源",Oe:"王天琦",Me:"王泽通",Ne:"万馨联",je:"闻思奕",_e:"吴锦鸿",Fe:"吴润泽",ze:"巫昱恺",Ge:"项际诚",He:"肖贯勋",Je:"肖嘉盛",Ve:"夏瑞成",qe:"夏蔚民",$e:"夏诩然",Xe:"谢秉修",Ye:"谢立仁",We:"辛轶涵",Ke:"徐从瀚",Ze:"徐衎",Qe:"徐维易",et:"杨皓宸",tt:"叶梓炅",nt:"尤周杭",ot:"袁瑞擎",it:"于庭郡",rt:"张宸铭",lt:"张秋泽",dt:"张澍萱",ct:"张闻达",st:"张亦夫",ut:"张佑恒",bt:"赵晨神",ht:"赵晨伟",vt:"郑逸楠",yt:"钟弘毅",gt:"周峻瑜",ft:"周子逸",St:"周子游",Tt:"朱晨瑞",Ct:"朱睿宸",wt:"朱徐乐",Et:"朱奕坤"});b.innerText=null==y[c.u]?"":y[c.u],h.innerText=c.h,v.innerText=SecondsToString(c.v);for(let t=0;t<T;t++){var g,f=document.createElement("td"),S=(m.appendChild(f),c.g.find(e=>{if(e.S==t)return!0}));null==S?f.style.backgroundColor="#eeeeee":0!=S.C?(f.innerText=SecondsToString(S.C)+"("+S.T.length+")",g=Math.min(10*S.T.length,224),f.style.backgroundColor="rgb("+g+", 255, "+g+")",f.style.color="black"):(f.innerText="("+S.T.length+")",g=255-Math.min(10*S.T.length,224),f.style.backgroundColor="rgb(255, "+g+", "+g+")",f.style.color=g<64?"white":"black")}}TidyTable(t),scrollTo({left:C,top:w,behavior:"instant"})}})},DownloadButton=(document.getElementById("rank").style.width="100%",document.createElement("button")),ProblemCount=(document.querySelector("body > div.container > div > center").insertBefore(DownloadButton,document.querySelector("body > div.container > div > center > a")),DownloadButton.className="btn btn-outline-secondary",DownloadButton.innerText="下载排名",DownloadButton.style.marginBottom="20px",DownloadButton.onclick=()=>{location.href="/contestrank.xls.php?cid="+new URLSearchParams(location.search).get("cid")},localStorage.getItem("UserScript-Contest-"+new URLSearchParams(location.search).get("cid")+"-ProblemCount"));ReloadRank(ProblemCount),UtilityEnabled("AutoRefresh")&&(onfocus=()=>{ReloadRank(ProblemCount)})}Style.innerHTML+="td {",Style.innerHTML+="   white-space: nowrap;",Style.innerHTML+="}",document.querySelector("body > div.container > div > center").style.paddingBottom="10px",document.querySelector("body > div.container > div > center > a").style.display="none"}else if("/contestrank-correct.php"==location.pathname)null==document.querySelector("#rank")&&(document.querySelector("body > div > div").innerHTML='<center><h3>比赛排名</h3><a></a><table id="rank"></table>'),"比赛排名"==document.querySelector("body > div > div > center > h3").innerText?document.querySelector("#rank").innerText="比赛暂时还没有排名":(UtilityEnabled("ResetType")&&(document.querySelector("body > div > div > center > h3").innerText=document.querySelector("body > div > div > center > h3").innerText.substring(document.querySelector("body > div > div > center > h3").innerText.indexOf(" -- ")+4)+"（订正排名）",document.querySelector("body > div > div > center > a").remove()),document.querySelector("#rank > thead > tr > :nth-child(1)").innerText="排名",document.querySelector("#rank > thead > tr > :nth-child(2)").innerText="用户",document.querySelector("#rank > thead > tr > :nth-child(3)").innerText="昵称",document.querySelector("#rank > thead > tr > :nth-child(4)").innerText="AC数",document.querySelector("#rank > thead > tr > :nth-child(5)").innerText="得分",onfocus=async()=>{await fetch(location.href).then(e=>e.text()).then(e=>{for(var e=(new DOMParser).parseFromString(e,"text/html"),t=(TidyTable(e.getElementById("rank")),e.getElementById("rank").rows),n=1;n<t.length;n++){var o=t[n].cells[0],a=document.createElement("span");a.innerText=o.innerText,a.className="badge text-bg-primary",o.innerText="",o.appendChild(a),t[n].cells[1].children[0].className="link-primary link-offset-2 link-underline-opacity-50",t[n].cells[1].children[0].target="_blank",t[n].cells[2].innerHTML=t[n].cells[2].innerText,t[n].cells[3].innerHTML=t[n].cells[3].innerText}document.querySelector("#rank > tbody").innerHTML=e.querySelector("#rank > tbody").innerHTML})},onfocus(),UtilityEnabled("AutoRefresh")||(onfocus=null));else if("/submitpage.php"==location.pathname){UtilityEnabled("AutoO2")&&(document.querySelector("#enable_O2").checked=!0),document.querySelector("#frmSolution").childNodes[0].nodeValue="题目",document.querySelector("#language_span").childNodes[0].nodeValue="语言：",document.querySelector("#language").style.marginTop="10px",document.querySelector("#language").style.marginBottom="10px",document.querySelector("#source").classList.add("form-control");let CheckInterval=setInterval(()=>{null!=document.querySelector("#edit_area_toggle_reg_syntax\\.js > label")&&(document.querySelector("#EditAreaArroundInfos_source").style.display="block",document.querySelector("#EditAreaArroundInfos_source").style.height="0px",document.querySelector("#edit_area_toggle_reg_syntax\\.js > label").innerText="使用编辑器",clearInterval(CheckInterval))},100);if(UtilityEnabled("ResetType")){let O2Label=document.createElement("label"),Temp=(document.querySelector("#frmSolution").insertBefore(O2Label,document.querySelector("#enable_O2").nextElementSibling),O2Label.innerText="打开O2开关",O2Label.setAttribute("for","enable_O2"),document.querySelector("#frmSolution").childNodes);for(let i=0;i<Temp.length;i++)"打开O2开关"==Temp[i].data?(Temp[i].remove(),i--):"EditAreaArroundInfos_source"==Temp[i].id?Temp[i+1].remove():null!=Temp[i].getAttribute&&"enable_O2"==Temp[i].getAttribute("for")&&(Temp[i+1].remove(),Temp[i+1].remove())}let ErrorElement=document.createElement("div"),ErrorMessage=(ErrorElement.style.marginTop="10px",ErrorElement.style.display="none",ErrorElement.style.textAlign="left",ErrorElement.style.padding="10px",document.querySelector("body > div > div > center").appendChild(ErrorElement),document.createElement("div")),PassCheck=(ErrorMessage.style.whiteSpace="pre",ErrorMessage.style.backgroundColor="rgb(0, 0, 0, 0.1)",ErrorMessage.style.padding="10px",ErrorMessage.style.borderRadius="5px",ErrorElement.appendChild(ErrorMessage),document.createElement("button"));PassCheck.style.display="none",PassCheck.className="btn btn-outline-secondary",PassCheck.style.marginTop="10px",PassCheck.innerText="强制提交",PassCheck.onclick=()=>{document.querySelector("#Submit").disabled=!0,document.querySelector("#Submit").value="正在提交...",document.querySelector("#frmSolution").submit()},ErrorElement.appendChild(PassCheck),document.querySelector("#Submit").type="button",document.querySelector("#Submit").onclick=async()=>{PassCheck.style.display="none",ErrorElement.style.display="none",document.querySelector("#Submit").disabled=!0,document.querySelector("#Submit").value="正在检查...",eAL.toggle("source"),eAL.toggle("source");var n=document.getElementById("source").value,e=new URL(location.href).searchParams;let t=0;if(t=null!=e.get("cid")&&null!=e.get("pid")?localStorage.getItem("UserScript-Contest-"+e.get("cid")+"-Problem-"+e.get("pid")+"-PID"):e.get("id"),e=localStorage.getItem("UserScript-Problem-"+t+"-IOFilename"),UtilityEnabled("IOFile")&&null!=e){if(-1==n.indexOf(e))return PassCheck.style.display="",ErrorElement.style.display="block",ErrorMessage.style.color="red",ErrorMessage.innerText="此题输入输出文件名为"+e+"，请检查是否填错",document.querySelector("#Submit").disabled=!1,!(document.querySelector("#Submit").value="提交");if(RegExp("//.*freopen").test(n))return PassCheck.style.display="",ErrorElement.style.display="block",ErrorMessage.style.color="red",ErrorMessage.innerText="请不要注释freopen",document.querySelector("#Submit").disabled=!1,!(document.querySelector("#Submit").value="提交")}if(""==n)return PassCheck.style.display="",ErrorElement.style.display="block",ErrorMessage.style.color="red",ErrorMessage.innerText="源代码为空",document.querySelector("#Submit").disabled=!1,!(document.querySelector("#Submit").value="提交");if(UtilityEnabled("CompileError"))for(let t=0;t<5;t++){let e=new AbortController;if(setTimeout(()=>{e.abort()},2e3),await fetch("https://gcc.godbolt.org/api/compiler/g131/compile",{headers:{accept:"application/json"},body:n,method:"POST",signal:e.signal}).then(e=>e.json()).then(t=>{var n=new AnsiUp;let o="";for(let e=0;e<t.stderr.length;e++)o+=n.ansi_to_html(t.stderr[e].text)+"<br>";if(""!=o)return PassCheck.style.display="",ErrorElement.style.display="block",ErrorMessage.style.color="",ErrorMessage.innerHTML="编译错误：<br>"+o,document.querySelector("#Submit").disabled=!1,!(document.querySelector("#Submit").value="提交");ErrorElement.style.display="none"}).catch(e=>(console.log(e),ErrorElement.style.display="block",ErrorMessage.style.color="red",4!=t?ErrorMessage.innerText="预编译超时，正在重试("+(t+1)+"/5)":(PassCheck.style.display="",ErrorMessage.innerText="预编译超时，请重试或者点击下方按钮强制提交",document.querySelector("#Submit").disabled=!1,document.querySelector("#Submit").value="提交"),!1)),"none"==ErrorElement.style.display){PassCheck.click();break}}else PassCheck.click()}}else if("/modifypage.php"==location.pathname){if(UtilityEnabled("ResetType")){document.querySelector("body > div.container > div > form > center > table > tbody > tr:nth-child(1) > td").innerText="修改账号";for(let i=3;i<=12;i++)document.querySelector("body > div.container > div > form > center > table > tbody > tr:nth-child("+i+") > td:nth-child(2) > input").classList.add("form-control"),document.querySelector("body > div.container > div > form > center > table > tbody > tr:nth-child("+i+") > td:nth-child(2) > input").style.marginBottom="5px";document.querySelector("body > div.container > div > form > center > table > tbody > tr:nth-child(2) > td:nth-child(1)").innerText="用户ID";let Temp=document.querySelector("body > div.container > div > form > center > table > tbody > tr:nth-child(13) > td:nth-child(2) > input:nth-child(1)");Temp.classList.add("form-control"),Temp.style.width="40%",Temp.style.display="inline-block",Temp.value="修改",Temp=document.querySelector("body > div.container > div > form > center > table > tbody > tr:nth-child(13) > td:nth-child(2) > input:nth-child(2)"),Temp.classList.add("form-control"),Temp.style.width="40%",Temp.style.display="inline-block",Temp.value="重置",document.querySelector("body > div.container > div > form > center > table > tbody > tr:nth-child(13) > td:nth-child(2)").childNodes[1].remove(),document.querySelector("body > div.container > div > form > a").remove()}if(UtilityEnabled("ExportACCode")){let ExportACCode=document.createElement("button");document.querySelector("body > div.container > div").appendChild(ExportACCode),ExportACCode.innerText="导出AC代码",ExportACCode.className="btn btn-outline-secondary",ExportACCode.onclick=()=>{ExportACCode.disabled=!0;let r=document.getElementsByTagName("progress")[0]||document.createElement("progress"),e=(r.removeAttribute("value"),r.removeAttribute("max"),document.querySelector("body > div.container > div").appendChild(r),ExportACCode.innerText="正在导出...",new XMLHttpRequest);e.onreadystatechange=()=>{if(4==e.readyState)if(200==e.status){let a=e.responseText.split("------------------------------------------------------\r\n"),i=(r.max=a.length-1,t=>{if(t>=a.length)ExportACCode.innerText="导出成功",ExportACCode.disabled=!1,r.remove(),setTimeout(()=>{ExportACCode.innerText="导出AC代码"},1e3);else{let e=a[t];var n,o;""!=e&&(n=e.substring(7,11),e=e.substring(14),r.value=t+1,(o=document.createElement("a")).href=window.URL.createObjectURL(new Blob([e])),o.download=n+".cpp",o.click()),setTimeout(()=>{i(t+1)},50)}});i(0)}else ExportACCode.disabled=!1,ExportACCode.innerText="导出失败",setTimeout(()=>{ExportACCode.innerText="导出AC代码"},1e3)},e.open("GET","http://www.xmoj.tech/export_ac_code.php",!0),e.send()}}}else if("/userinfo.php"==location.pathname){if(UtilityEnabled("RemoveUseless")){let Temp=document.getElementById("submission").childNodes;for(let i=0;i<Temp.length;i++)Temp[i].remove()}eval(document.querySelector("body > script:nth-child(5)").innerHTML),document.querySelector("#statics > caption").remove(),document.querySelector("#statics > tbody > tr:nth-child(1) > td:nth-child(3)").innerText="AC题目列表";let Temp=document.querySelector("#statics > tbody").children;for(let i=0;i<Temp.length;i++)null!=Temp[i].children[0]&&("Statistics"==Temp[i].children[0].innerText?Temp[i].children[0].innerText="统计":"Email:"==Temp[i].children[0].innerText?Temp[i].children[0].innerText="电子邮箱":Temp[i].children[1].innerText=Temp[i].children[1].innerText)}else if("/conteststatistics.php"==location.pathname){if(document.querySelector("body > div > div > center > h3").innerText="比赛统计",UtilityEnabled("ResetType")){let Temp=document.getElementById("submission").childNodes;for(let i=0;i<Temp.length;i++)Temp[i].remove();eval(document.querySelector("body > div.container > div > center > table:nth-child(4) > script:nth-child(6)").innerHTML),document.querySelector("#cs > thead > tr > th:nth-child(1)").innerText="题目编号",document.querySelector("#cs > thead > tr > th:nth-child(10)").remove(),document.querySelector("#cs > thead > tr > th:nth-child(11)").innerText="总和",document.querySelector("#cs > thead > tr > th:nth-child(12)").remove(),document.querySelector("#cs > thead > tr > th:nth-child(12)").remove(),document.querySelector("#cs > thead > tr > th:nth-child(12)").remove(),document.querySelector("#cs > tbody > tr:last-child > td").innerText="总和",TidyTable(document.getElementById("cs")),Temp=document.querySelector("#cs > tbody").children;for(let i=0;i<Temp.length;i++){let CurrentRowChildren=Temp[i].children;CurrentRowChildren[9].remove(),CurrentRowChildren[11].remove(),CurrentRowChildren[11].remove(),CurrentRowChildren[11].remove();for(let j=0;j<CurrentRowChildren.length;j++)""==CurrentRowChildren[j].innerText&&(CurrentRowChildren[j].innerText="0")}}}else if("/comparesource.php"==location.pathname){if(UtilityEnabled("CompareSource"))if(""==location.search){document.querySelector("body > div.container > div").innerHTML="";let LeftCodeText=document.createElement("span"),LeftCode=(document.querySelector("body > div.container > div").appendChild(LeftCodeText),LeftCodeText.innerText="左侧代码的运行编号：",document.createElement("input")),RightCodeText=(document.querySelector("body > div.container > div").appendChild(LeftCode),LeftCode.classList.add("form-control"),LeftCode.style.width="40%",LeftCode.style.marginBottom="5px",document.createElement("span")),RightCode=(document.querySelector("body > div.container > div").appendChild(RightCodeText),RightCodeText.innerText="右侧代码的运行编号：",document.createElement("input")),CompareButton=(document.querySelector("body > div.container > div").appendChild(RightCode),RightCode.classList.add("form-control"),RightCode.style.width="40%",RightCode.style.marginBottom="5px",document.createElement("button"));document.querySelector("body > div.container > div").appendChild(CompareButton),CompareButton.innerText="比较",CompareButton.className="btn btn-outline-secondary",CompareButton.onclick=()=>{location.href="/comparesource.php?left="+LeftCode.value+"&right="+RightCode.value}}else{let CheckboxLabel=document.createElement("label");document.querySelector("body > div.container > div > table:nth-child(2) > tbody > tr > td").appendChild(CheckboxLabel),CheckboxLabel.innerText="忽略空白",CheckboxLabel.setAttribute("for","ignorews"),document.querySelector("body > div.container > div > table:nth-child(2) > tbody > tr > td").childNodes[1].remove(),document.querySelector("body > div.container > div > table:nth-child(4) > tbody > tr").children[0].children[1].innerText="保存代码",document.querySelector("body > div.container > div > table:nth-child(4) > tbody > tr").children[0].children[1].download=new URLSearchParams(location.search).get("left")+".cpp",document.querySelector("body > div.container > div > table:nth-child(4) > tbody > tr").children[1].children[1].innerText="保存代码",document.querySelector("body > div.container > div > table:nth-child(4) > tbody > tr").children[1].children[1].download=new URLSearchParams(location.search).get("right")+".cpp",setInterval(()=>{document.querySelector("body > div.container > div > table:nth-child(4) > tbody > tr").children[0].children[0].innerText="左侧代码"+new URLSearchParams(location.search).get("left"),document.querySelector("body > div.container > div > table:nth-child(4) > tbody > tr").children[1].children[0].innerText="右侧代码"+new URLSearchParams(location.search).get("right")},500)}}else if("/loginpage.php"==location.pathname){UtilityEnabled("NewBootstrap")&&(document.querySelector("#login").innerHTML=`<form id="login" action="login.php" method="post">
        <div class="row g-3 align-items-center mb-3">
            <div class="col-auto">
            <label for="user_id" class="col-form-label">用户名（学号）</label>
            </div>
            <div class="col-auto">
            <input type="text" id="user_id" name="user_id" class="form-control">
            </div>
        </div>
        <div class="row g-3 align-items-center mb-3">
            <div class="col-auto">
            <label for="password" class="col-form-label">密码</label>
            </div>
            <div class="col-auto">
            <input type="password" id="password" name="password" class="form-control">
            </div>
        </div>
        <div class="row g-3 align-items-center mb-3">
            <div class="col-auto">
            <button name="submit" type="button" class="btn btn-primary">登录</button>
            </div>
            <div class="col-auto">
            <a class="btn btn-warning" href="lostpassword.php">忘记密码</a>
            </div>
        </div>
        </form>`);let ErrorText=document.createElement("div"),LoginButton=(ErrorText.style.color="red",ErrorText.style.marginBottom="5px",document.querySelector("#login").appendChild(ErrorText),document.getElementsByName("submit")[0]);LoginButton.onclick=async()=>{let t=document.getElementsByName("user_id")[0].value,n=document.getElementsByName("password")[0].value;""==t||""==n?ErrorText.innerText="用户名或密码不能为空":await fetch("http://www.xmoj.tech/login.php",{method:"POST",headers:{Ut:"application/x-www-form-urlencoded"},body:"user_id="+encodeURIComponent(t)+"&password="+hex_md5(n)}).then(e=>e.text()).then(e=>{if(UtilityEnabled("LoginFailed"))if(-1!=e.indexOf("history.go(-2);")){UtilityEnabled("SavePassword")&&(localStorage.setItem("UserScript-Username",t),localStorage.setItem("UserScript-Password",n));let e=localStorage.getItem("UserScript-LastPage");null==e&&(e="/index.php"),location.href=e}else UtilityEnabled("SavePassword")&&(localStorage.removeItem("UserScript-Username"),localStorage.removeItem("UserScript-Password")),e=(e=e.substring(e.indexOf("alert('")+7)).substring(0,e.indexOf("');")),ErrorText.innerText="UserName or Password Wrong!"==e?"用户名或密码错误！":e;else document.innerHTML=e})},UtilityEnabled("SavePassword")&&null!=localStorage.getItem("UserScript-Username")&&null!=localStorage.getItem("UserScript-Password")&&(document.querySelector("#login > div:nth-child(1) > div > input").value=localStorage.getItem("UserScript-Username"),document.querySelector("#login > div:nth-child(2) > div > input").value=localStorage.getItem("UserScript-Password"),LoginButton.click())}else if("/contest_video.php"==location.pathname){if(UtilityEnabled("DownloadPlayback")){let ScriptData=document.querySelector("body > div > div > center > script").innerHTML,VideoData=(""!=document.getElementById("J_prismPlayer0").innerHTML&&(document.getElementById("J_prismPlayer0").innerHTML="",eval(ScriptData)),ScriptData=ScriptData.substring(ScriptData.indexOf("{")),ScriptData=ScriptData.substring(0,ScriptData.indexOf("}")+1),ScriptData=ScriptData.replace(/([a-zA-Z0-9]+) ?:/g,'"$1":'),ScriptData=ScriptData.replace(/'/g,'"'),JSON.parse(ScriptData)),RandomUUID=()=>{var t="0123456789abcdef",n=[];for(let e=0;e<36;e++)n[e]=t.substr(Math.floor(16*Math.random()),1);return n[14]="4",n[19]=t.substr(3&n[19]|8,1),n[8]=n[13]=n[18]=n[23]="-",n.join("")},URLParams=new URLSearchParams({xt:VideoData.accessKeyId,Dt:"GetPlayInfo",kt:VideoData.vid,It:"",Rt:7200,At:RandomUUID(),Pt:VideoData.securityToken,Bt:"video",Lt:"JSON",Ot:"2017-03-21",Mt:"HMAC-SHA1",Nt:"1.0",jt:RandomUUID(),_t:"2.9.3",Ft:"HTML5"});URLParams.sort(),await fetch("https://vod."+VideoData.region+".aliyuncs.com/?"+URLParams.toString()+"&Signature="+encodeURIComponent(CryptoJS.HmacSHA1("GET&%2F&"+encodeURIComponent(URLParams.toString()),VideoData.accessKeySecret+"&").toString(CryptoJS.enc.Base64))).then(e=>e.json()).then(e=>{var t=document.createElement("a");t.className="btn btn-outline-secondary",t.innerText="下载",t.href=e.PlayInfoList.PlayInfo[0].PlayURL,t.download=e.VideoBase.Title,document.querySelector("body > div > div > center").appendChild(t)})}}else if("/reinfo.php"==location.pathname)if(null==document.querySelector("#results > div"))document.querySelector("#results").parentElement.innerHTML="没有测试点信息";else for(let i=0;i<document.querySelector("#results > div").children.length;i++){let CurrentElement=document.querySelector("#results > div").children[i].children[0].children[0].children[0],Temp=CurrentElement.innerText.substring(0,CurrentElement.innerText.length-2).split("/"),CopyButton=(CurrentElement.innerText=TimeToStringTime(Temp[0])+"/"+SizeToStringSize(Temp[1]),CurrentElement=CurrentElement.parentNode.parentNode,document.createElement("div"));CurrentElement.appendChild(CopyButton),CopyButton.style.display="none",CopyButton.style.position="absolute",CopyButton.style.fontSize="12px",CopyButton.style.margin="6px",CopyButton.innerText="点此复制获取数据的语句",CurrentElement.onmouseover=()=>{var t=CurrentElement.children;for(let e=0;e<t.length;e++)t[e].style.display="none";t[t.length-1].style.display=""},CurrentElement.onmouseout=()=>{var t=CurrentElement.children;for(let e=0;e<t.length;e++)t[e].style.display="";t[t.length-1].style.display="none"},CurrentElement.onclick=()=>{var e,t,n,o,a,i=new URLSearchParams(location.search).get("sid"),r=localStorage.getItem("UserScript-Solution-"+i+"-Contest");null==r?(e=localStorage.getItem("UserScript-Solution-"+i+"-Problem"),t=localStorage.getItem("UserScript-Problem-"+e+"-Name"),n=CurrentElement.children[1].innerText.substring(1),CopyToClipboard("高老师，能发给我"+e+"题："+t+"，提交编号"+i+"，#"+n+"测试点的数据吗？谢谢")):(e=localStorage.getItem("UserScript-Contest-"+r+"-Name"),t=localStorage.getItem("UserScript-Solution-"+i+"-PID-Contest"),n=localStorage.getItem("UserScript-Contest-"+r+"-Problem-"+(t.charCodeAt(0)-65)+"-PID"),o=localStorage.getItem("UserScript-Problem-"+n+"-Name"),a=CurrentElement.children[1].innerText.substring(1),CopyToClipboard("高老师，能发给我比赛"+r+"："+e+"，"+t+"题("+n+")："+o+"，提交编号"+i+"，#"+a+"测试点的数据吗？谢谢")),CopyButton.innerText="已复制",setTimeout(()=>{CopyButton.innerText="点此复制获取数据的语句"},1e3)},CurrentElement.onmouseout()}else if("/downloads.php"==location.pathname){if(UtilityEnabled("NewDownload")){let Softwares=[{l:"Bloodshed Dev-C++",Image:"https://a.fsdn.com/allura/p/dev-cpp/icon",URL:"https://sourceforge.net/projects/dev-cpp/"},{l:"Orwell Dev-C++",Image:"https://a.fsdn.com/allura/p/orwelldevcpp/icon",URL:"https://sourceforge.net/projects/orwelldevcpp/"},{l:"Embarcadero Dev-C++",Image:"https://a.fsdn.com/allura/s/embarcadero-dev-cpp/icon",URL:"https://sourceforge.net/software/product/Embarcadero-Dev-Cpp/"},{l:"Code::Blocks",Image:"https://a.fsdn.com/allura/p/codeblocks/icon",URL:"https://sourceforge.net/projects/codeblocks/"},{l:"Visual Studio Code",Image:"https://code.visualstudio.com/favicon.ico",URL:"https://code.visualstudio.com/Download"},{l:"Lazarus",Image:"https://a.fsdn.com/allura/p/lazarus/icon",URL:"https://sourceforge.net/projects/lazarus/"},{l:"Geany",Image:"https://www.geany.org/static/img/geany.svg",URL:"https://www.geany.org/download/releases/"},{l:"NOI Linux",Image:"https://www.noi.cn/upload/resources/image/2021/07/16/163780.jpg",URL:"https://www.noi.cn/gynoi/jsgz/2021-07-16/732450.shtml"},{l:"Virtual box",Image:"https://www.virtualbox.org/graphics/vbox_logo2_gradient.png",URL:"https://www.virtualbox.org/wiki/Downloads"},{l:"MinGW",Image:"https://www.mingw-w64.org/logo.svg",URL:"https://sourceforge.net/projects/mingw/"}];document.querySelector("body > div > ul").innerHTML="";for(let i=0;i<Softwares.length;i++)document.querySelector("body > div > ul").innerHTML+='<li class="software_item"><a href="'+Softwares[i].URL+'"><div class="item-info"><div class="item-img"><img height="50" src="'+Softwares[i].Image+'" alt="点击下载"></div><div class="item-txt">'+Softwares[i].l+"</div></div></a></li>"}}else if("/problemstatus.php"==location.pathname){document.querySelector("body > div > div > center").insertBefore(document.querySelector("#statics"),document.querySelector("body > div > div > center > table")),document.querySelector("body > div > div > center").insertBefore(document.querySelector("#problemstatus"),document.querySelector("body > div > div > center > table")),document.querySelector("body > div > div > center > table:nth-child(3)").remove();let Temp=document.querySelector("#statics").rows;for(let i=0;i<Temp.length;i++)Temp[i].removeAttribute("class"),2==Temp[i].children.length&&(Temp[i].children[1].innerHTML=Temp[i].children[1].innerText);document.querySelector("#problemstatus > thead > tr").innerHTML=document.querySelector("#problemstatus > thead > tr").innerHTML.replaceAll("td","th"),document.querySelector("#problemstatus > thead > tr > th:nth-child(2)").innerText="运行编号",document.querySelector("#problemstatus > thead > tr > th:nth-child(4)").remove(),document.querySelector("#problemstatus > thead > tr > th:nth-child(4)").remove(),document.querySelector("#problemstatus > thead > tr > th:nth-child(4)").remove(),document.querySelector("#problemstatus > thead > tr > th:nth-child(4)").remove(),Temp=document.querySelector("#problemstatus > thead > tr").children;for(let i=0;i<Temp.length;i++)Temp[i].removeAttribute("class");Temp=document.querySelector("#problemstatus > tbody").children;for(let i=0;i<Temp.length;i++)null!=Temp[i].children[5].children[0]&&(Temp[i].children[1].innerHTML='<a href="'+Temp[i].children[5].children[0].href+'">'+Temp[i].children[1].innerText+"</a>"),Temp[i].children[3].remove(),Temp[i].children[3].remove(),Temp[i].children[3].remove(),Temp[i].children[3].remove();let CurrentPage=parseInt(new URLSearchParams(location.search).get("page")||1),PID=new URLSearchParams(location.search).get("id"),Pagination='<nav class="center"><ul class="pagination justify-content-center">';1!=CurrentPage&&(Pagination+='<li class="page-item"><a href="problemstatus.php?id='+PID+'&page=1" class="page-link">&lt;&lt;</a></li><li class="page-item"><a href="problemstatus.php?id='+PID+"&page="+(CurrentPage-1)+'" class="page-link">'+(CurrentPage-1)+"</a></li>"),Pagination+='<li class="active page-item"><a href="problemstatus.php?id='+PID+"&page="+CurrentPage+'" class="page-link">'+CurrentPage+"</a></li>",null!=document.querySelector("#problemstatus > tbody").children&&20==document.querySelector("#problemstatus > tbody").children.length&&(Pagination+='<li class="page-item"><a href="problemstatus.php?id='+PID+"&page="+(CurrentPage+1)+'" class="page-link">'+(CurrentPage+1)+'</a></li><li class="page-item"><a href="problemstatus.php?id='+PID+"&page="+(CurrentPage+1)+'" class="page-link">&gt;&gt;</a></li>'),Pagination+="</ul></nav>",document.querySelector("body > div > div > center").innerHTML+=Pagination}if(UtilityEnabled("RemoveUseless")&&null!=document.getElementsByClassName("footer")[0]&&document.getElementsByClassName("footer")[0].remove(),UtilityEnabled("ReplaceYN")){Temp=document.getElementsByClassName("status_y");for(let i=0;i<Temp.length;i++)Temp[i].innerText="✓";Temp=document.getElementsByClassName("status_n");for(let i=0;i<Temp.length;i++)Temp[i].innerText="✗"}Temp=document.getElementsByClassName("page-item");for(let i=0;i<Temp.length;i++)Temp[i].children[0].className="page-link";null!=document.getElementsByClassName("pagination")[0]&&document.getElementsByClassName("pagination")[0].classList.add("justify-content-center"),Temp=document.getElementsByTagName("table");for(let i=0;i<Temp.length;i++)null!=Temp[i].querySelector("thead")&&TidyTable(Temp[i]);if(setInterval(()=>{if(UtilityEnabled("ResetType"))if(null!=document.querySelector("#profile")&&"登录"==document.querySelector("#profile").innerHTML)3==document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul").childNodes.length&&document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul").childNodes[3].remove();else if(null!=document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul > li:nth-child(3) > a > span")&&"个人中心"!=document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul > li:nth-child(3) > a > span").innerText){document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul > li:nth-child(3) > a > span").innerText="个人中心",document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul > li:nth-child(4)").remove(),document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul > li:nth-child(4)").remove(),document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul > li:nth-child(4)").remove(),document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul").innerHTML=String(document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul").innerHTML).replaceAll("&nbsp;","");for(var e=document.querySelector("#navbar > ul.nav.navbar-nav.navbar-right > li > ul").children,t=0;t<e.length;t++)"li"!=e[t].tagName.toLowerCase()&&e[t].remove(),e[t].classList.add("dropdown-item")}if(null!=document.querySelector(".syntaxhighlighter > table > tbody > tr > td.code > div")&&2==document.querySelector(".syntaxhighlighter").children.length){let e=document.createElement("button");e.className="btn btn-outline-secondary",e.innerText="复制代码",e.style.marginBottom="10px",e.addEventListener("click",()=>{CopyToClipboard(document.querySelector(".syntaxhighlighter > table > tbody > tr > td.code > div").innerText.replaceAll(" "," ")),e.innerText="复制成功",setTimeout(()=>{e.innerText="复制代码"},1e3)}),document.querySelector(".syntaxhighlighter").insertBefore(e,document.querySelector(".syntaxhighlighter").firstChild)}if(UtilityEnabled("AutoCountdown")){var n=document.getElementsByClassName("UpdateByJS");for(let e=0;e<n.length;e++){var o=parseInt(n[e].getAttribute("EndTime"))-(new Date).getTime()-diff,a=(o<3e3&&location.reload(),new Date(o)),o=parseInt(o/1e3/60/60/24),i=a.getUTCHours(),r=a.getUTCMinutes(),a=a.getUTCSeconds();n[e].innerText=(0!=o?o+"天":"")+(0!=i?(i<10?"0":"")+i+"小时":"")+(0!=r?(r<10?"0":"")+r+"分":"")+(0!=a?(a<10?"0":"")+a+"秒":"")}}},100),UtilityEnabled("NewBootstrap")){let BootStrapInterval=setInterval(()=>{"undefined"!=typeof bootstrap&&([...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map(e=>new bootstrap.Tooltip(e)),clearInterval(BootStrapInterval))},100)}await fetch("https://langningchen.github.io/XMOJ-Script/Version.html",{cache:"no-cache"}).then(e=>e.text()).then(e=>{GM_info.script.version<e.trim()&&(location.href="https://langningchen.github.io/XMOJ-Script/XMOJ.min.user.js")}),await fetch("https://langningchen.github.io/XMOJ-Script/AddonScript.js").then(e=>e.text()).then(Response=>{eval(Response)})}})();